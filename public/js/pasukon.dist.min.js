!function e(t,r,a){function n(o,p){if(!r[o]){if(!t[o]){var L="function"==typeof require&&require;if(!p&&L)return L(o,!0);if(s)return s(o,!0);var i=new Error("Cannot find module '"+o+"'");throw i.code="MODULE_NOT_FOUND",i}var h=r[o]={exports:{}};t[o][0].call(h.exports,(function(e){return n(t[o][1][e]||e)}),h,h.exports,e,t,r,a)}return r[o].exports}for(var s="function"==typeof require&&require,o=0;o<a.length;o++)n(a[o]);return n}({1:[function(e,t,r){(function(t){t.Pasukon=e("./pasukon")}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./pasukon":20}],2:[function(e,t,r){var a;a=this,"object"==typeof t?t.exports=[{type:"LEXER",tokens:[{type:"TOKEN_DEFINITION",name:"LEX_CLOSE",matcher:{type:"TOKEN_MATCHER",match:"/lex"},action:"match"},{type:"TOKEN_DEFINITION",name:"LEX_OPEN",matcher:{type:"TOKEN_REGEX_MATCHER",regex:/^lex\s+/},action:"match"},{type:"TOKEN_DEFINITION",name:"MATCH",matcher:{type:"TOKEN_REGEX_MATCHER",regex:/^match\s+/},action:"match"},{type:"TOKEN_DEFINITION",name:"IGNORE",matcher:{type:"TOKEN_MATCHER",match:"ignore"},action:"match"},{type:"TOKEN_DEFINITION",name:"COLON",matcher:{type:"TOKEN_MATCHER",match:":"},action:"match"},{type:"TOKEN_DEFINITION",name:"SEMICOLON",matcher:{type:"TOKEN_MATCHER",match:";"},action:"match"},{type:"TOKEN_DEFINITION",name:"PIPE_ARROW",matcher:{type:"TOKEN_MATCHER",match:"|>"},action:"match"},{type:"TOKEN_DEFINITION",name:"PIPE",matcher:{type:"TOKEN_MATCHER",match:"|"},action:"match"},{type:"TOKEN_DEFINITION",name:"POPEN",matcher:{type:"TOKEN_MATCHER",match:"("},action:"match"},{type:"TOKEN_DEFINITION",name:"PCLOSE",matcher:{type:"TOKEN_MATCHER",match:")"},action:"match"},{type:"TOKEN_DEFINITION",name:"QUESTION_MARK",matcher:{type:"TOKEN_MATCHER",match:"?"},action:"match"},{type:"TOKEN_DEFINITION",name:"PLUS",matcher:{type:"TOKEN_MATCHER",match:"+"},action:"match"},{type:"TOKEN_DEFINITION",name:"TIMES",matcher:{type:"TOKEN_MATCHER",match:"*"},action:"match"},{type:"TOKEN_DEFINITION",name:"REGEX_MATCHER",matcher:{type:"TOKEN_REGEX_MATCHER",regex:/^\/[^\/]*\//},action:"match"},{type:"TOKEN_DEFINITION",name:"REGEX_MATCHER",matcher:{type:"TOKEN_REGEX_MATCHER",regex:/^{[^}]*}/},action:"match"},{type:"TOKEN_DEFINITION",name:"CODE",matcher:{type:"TOKEN_REGEX_MATCHER",regex:/^'[^']*'/},action:"match"},{type:"TOKEN_DEFINITION",name:"CODE",matcher:{type:"TOKEN_REGEX_MATCHER",regex:/^\"[^\"]*\"/},action:"match"},{type:"TOKEN_DEFINITION",name:"NAME",matcher:{type:"TOKEN_REGEX_MATCHER",regex:/^[a-zA-Z][a-zA-Z0-9_-]*/},action:"match"},{type:"TOKEN_DEFINITION",name:"WHITESPACE",matcher:{type:"TOKEN_REGEX_MATCHER",regex:/^\s+/},action:"ignore"}]},{type:"RULE",name:"token-action",definitions:[{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"MATCH"},code:function(e,t,r,a){return e.trim()}},{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"IGNORE"}}]},{type:"RULE",name:"token-matcher",definitions:[{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"CODE"},code:function(e,t,r,a){return{type:"TOKEN_MATCHER",match:e.substring(1,e.length-1)}}},{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"REGEX_MATCHER"},code:function(e,t,r,a){return{type:"TOKEN_REGEX_MATCHER",regex:e.substring(1,e.length-1)}}}]},{type:"RULE",name:"token-definition",definitions:[{type:"BINARY_CALL",parser:"then",lhs:{type:"BINARY_CALL",parser:"as",lhs:{type:"RULE_CALL",name:"token-action"},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"action"}}},rhs:{type:"BINARY_CALL",parser:"then",lhs:{type:"BINARY_CALL",parser:"as",lhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"NAME"}},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"name"}}},rhs:{type:"BINARY_CALL",parser:"as",lhs:{type:"RULE_CALL",name:"token-matcher"},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"matcher"}}}},code:function(e,t,r,a){return{type:"TOKEN_DEFINITION",name:r.name,matcher:r.matcher,action:r.action}}}]},{type:"RULE",name:"lexer",definitions:[{type:"BINARY_CALL",parser:"then",lhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"LEX_OPEN"}},rhs:{type:"BINARY_CALL",parser:"then",lhs:{type:"BINARY_CALL",parser:"as",lhs:{type:"UNARY_CALL",parser:"many0",arg:{type:"RULE_CALL",name:"token-definition"}},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"tokens"}}},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"LEX_CLOSE"}}},code:function(e,t,r,a){return{type:"LEXER",tokens:r.tokens}}}]},{type:"RULE",name:"parser-name",definitions:[{type:"BINARY_CALL",parser:"then",lhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"POPEN"}},rhs:{type:"BINARY_CALL",parser:"then",lhs:{type:"BINARY_CALL",parser:"as",lhs:{type:"RULE_CALL",name:"rule-expression"},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"expr"}}},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"PCLOSE"}}},code:function(e,t,r,a){return r.expr}},{type:"BINARY_CALL",parser:"then",lhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"QUESTION_MARK"}},rhs:{type:"BINARY_CALL",parser:"as",lhs:{type:"RULE_CALL",name:"parser-name"},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"arg"}}},code:function(e,t,r,a){return{type:"UNARY_CALL",parser:"opt",arg:r.arg}}},{type:"BINARY_CALL",parser:"then",lhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"PLUS"}},rhs:{type:"BINARY_CALL",parser:"as",lhs:{type:"RULE_CALL",name:"parser-name"},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"arg"}}},code:function(e,t,r,a){return{type:"UNARY_CALL",parser:"many1",arg:r.arg}}},{type:"BINARY_CALL",parser:"then",lhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"TIMES"}},rhs:{type:"BINARY_CALL",parser:"as",lhs:{type:"RULE_CALL",name:"parser-name"},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"arg"}}},code:function(e,t,r,a){return{type:"UNARY_CALL",parser:"many0",arg:r.arg}}},{type:"BINARY_CALL",parser:"then",lhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"COLON"}},rhs:{type:"BINARY_CALL",parser:"as",lhs:{type:"RULE_CALL",name:"parser-name"},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"arg"}}},code:function(e,t,r,a){return{type:"UNARY_CALL",parser:"token",arg:r.arg}}},{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"NAME"},code:function(e,t,r,a){return{type:"RULE_CALL",name:e}}}]},{type:"RULE",name:"rule-expression",definitions:[{type:"BINARY_CALL",parser:"then",lhs:{type:"BINARY_CALL",parser:"as",lhs:{type:"RULE_CALL",name:"parser-name"},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"lhs"}}},rhs:{type:"BINARY_CALL",parser:"then",lhs:{type:"BINARY_CALL",parser:"as",lhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"NAME"}},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"parser"}}},rhs:{type:"BINARY_CALL",parser:"as",lhs:{type:"RULE_CALL",name:"rule-expression"},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"rhs"}}}},code:function(e,t,r,a){return{type:"BINARY_CALL",parser:r.parser,lhs:r.lhs,rhs:r.rhs}}},{type:"BINARY_CALL",parser:"then",lhs:{type:"BINARY_CALL",parser:"as",lhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"NAME"}},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"name"}}},rhs:{type:"BINARY_CALL",parser:"as",lhs:{type:"RULE_CALL",name:"rule-expression"},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"arg"}}},code:function(e,t,r,a){return{type:"UNARY_CALL",parser:r.name,arg:r.arg}}},{type:"RULE_CALL",name:"parser-name"}]},{type:"RULE",name:"rule-eval",definitions:[{type:"BINARY_CALL",parser:"then",lhs:{type:"UNARY_CALL",parser:"opt",arg:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"PIPE_ARROW"}}},rhs:{type:"BINARY_CALL",parser:"as",lhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"CODE"}},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"code"}}},code:function(e,t,r,a){return r.code.substring(1,r.code.length-1)}}]},{type:"RULE",name:"rule-definition",definitions:[{type:"BINARY_CALL",parser:"then",lhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"PIPE"}},rhs:{type:"BINARY_CALL",parser:"then",lhs:{type:"BINARY_CALL",parser:"as",lhs:{type:"RULE_CALL",name:"rule-expression"},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"expr"}}},rhs:{type:"UNARY_CALL",parser:"opt",arg:{type:"BINARY_CALL",parser:"as",lhs:{type:"RULE_CALL",name:"rule-eval"},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"code"}}}}},code:function(e,t,r,a){return r.code&&(r.expr.code=r.code),r.expr}}]},{type:"RULE",name:"rule",definitions:[{type:"BINARY_CALL",parser:"then",lhs:{type:"BINARY_CALL",parser:"as",lhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"NAME"}},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"name"}}},rhs:{type:"BINARY_CALL",parser:"then",lhs:{type:"BINARY_CALL",parser:"as",lhs:{type:"UNARY_CALL",parser:"many1",arg:{type:"RULE_CALL",name:"rule-definition"}},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"definitions"}}},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"SEMICOLON"}}},code:function(e,t,r,a){return{type:"RULE",name:r.name,definitions:r.definitions}}}]},{type:"RULE",name:"rules",definitions:[{type:"UNARY_CALL",parser:"many0",arg:{type:"RULE_CALL",name:"rule"}}]},{type:"RULE",name:"start",definitions:[{type:"BINARY_CALL",parser:"then",lhs:{type:"BINARY_CALL",parser:"as",lhs:{type:"RULE_CALL",name:"lexer"},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"lexer"}}},rhs:{type:"BINARY_CALL",parser:"as",lhs:{type:"RULE_CALL",name:"rules"},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"rules"}}},code:function(e,t,r,a){return[r.lexer].concat(r.rules)}},{type:"RULE_CALL",name:"rules"}]}]:a.grammar=[{type:"LEXER",tokens:[{type:"TOKEN_DEFINITION",name:"LEX_CLOSE",matcher:{type:"TOKEN_MATCHER",match:"/lex"},action:"match"},{type:"TOKEN_DEFINITION",name:"LEX_OPEN",matcher:{type:"TOKEN_REGEX_MATCHER",regex:/^lex\s+/},action:"match"},{type:"TOKEN_DEFINITION",name:"MATCH",matcher:{type:"TOKEN_REGEX_MATCHER",regex:/^match\s+/},action:"match"},{type:"TOKEN_DEFINITION",name:"IGNORE",matcher:{type:"TOKEN_MATCHER",match:"ignore"},action:"match"},{type:"TOKEN_DEFINITION",name:"COLON",matcher:{type:"TOKEN_MATCHER",match:":"},action:"match"},{type:"TOKEN_DEFINITION",name:"SEMICOLON",matcher:{type:"TOKEN_MATCHER",match:";"},action:"match"},{type:"TOKEN_DEFINITION",name:"PIPE_ARROW",matcher:{type:"TOKEN_MATCHER",match:"|>"},action:"match"},{type:"TOKEN_DEFINITION",name:"PIPE",matcher:{type:"TOKEN_MATCHER",match:"|"},action:"match"},{type:"TOKEN_DEFINITION",name:"POPEN",matcher:{type:"TOKEN_MATCHER",match:"("},action:"match"},{type:"TOKEN_DEFINITION",name:"PCLOSE",matcher:{type:"TOKEN_MATCHER",match:")"},action:"match"},{type:"TOKEN_DEFINITION",name:"QUESTION_MARK",matcher:{type:"TOKEN_MATCHER",match:"?"},action:"match"},{type:"TOKEN_DEFINITION",name:"PLUS",matcher:{type:"TOKEN_MATCHER",match:"+"},action:"match"},{type:"TOKEN_DEFINITION",name:"TIMES",matcher:{type:"TOKEN_MATCHER",match:"*"},action:"match"},{type:"TOKEN_DEFINITION",name:"REGEX_MATCHER",matcher:{type:"TOKEN_REGEX_MATCHER",regex:/^\/[^\/]*\//},action:"match"},{type:"TOKEN_DEFINITION",name:"REGEX_MATCHER",matcher:{type:"TOKEN_REGEX_MATCHER",regex:/^{[^}]*}/},action:"match"},{type:"TOKEN_DEFINITION",name:"CODE",matcher:{type:"TOKEN_REGEX_MATCHER",regex:/^'[^']*'/},action:"match"},{type:"TOKEN_DEFINITION",name:"CODE",matcher:{type:"TOKEN_REGEX_MATCHER",regex:/^\"[^\"]*\"/},action:"match"},{type:"TOKEN_DEFINITION",name:"NAME",matcher:{type:"TOKEN_REGEX_MATCHER",regex:/^[a-zA-Z][a-zA-Z0-9_-]*/},action:"match"},{type:"TOKEN_DEFINITION",name:"WHITESPACE",matcher:{type:"TOKEN_REGEX_MATCHER",regex:/^\s+/},action:"ignore"}]},{type:"RULE",name:"token-action",definitions:[{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"MATCH"},code:function(e,t,r,a){return e.trim()}},{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"IGNORE"}}]},{type:"RULE",name:"token-matcher",definitions:[{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"CODE"},code:function(e,t,r,a){return{type:"TOKEN_MATCHER",match:e.substring(1,e.length-1)}}},{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"REGEX_MATCHER"},code:function(e,t,r,a){return{type:"TOKEN_REGEX_MATCHER",regex:e.substring(1,e.length-1)}}}]},{type:"RULE",name:"token-definition",definitions:[{type:"BINARY_CALL",parser:"then",lhs:{type:"BINARY_CALL",parser:"as",lhs:{type:"RULE_CALL",name:"token-action"},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"action"}}},rhs:{type:"BINARY_CALL",parser:"then",lhs:{type:"BINARY_CALL",parser:"as",lhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"NAME"}},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"name"}}},rhs:{type:"BINARY_CALL",parser:"as",lhs:{type:"RULE_CALL",name:"token-matcher"},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"matcher"}}}},code:function(e,t,r,a){return{type:"TOKEN_DEFINITION",name:r.name,matcher:r.matcher,action:r.action}}}]},{type:"RULE",name:"lexer",definitions:[{type:"BINARY_CALL",parser:"then",lhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"LEX_OPEN"}},rhs:{type:"BINARY_CALL",parser:"then",lhs:{type:"BINARY_CALL",parser:"as",lhs:{type:"UNARY_CALL",parser:"many0",arg:{type:"RULE_CALL",name:"token-definition"}},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"tokens"}}},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"LEX_CLOSE"}}},code:function(e,t,r,a){return{type:"LEXER",tokens:r.tokens}}}]},{type:"RULE",name:"parser-name",definitions:[{type:"BINARY_CALL",parser:"then",lhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"POPEN"}},rhs:{type:"BINARY_CALL",parser:"then",lhs:{type:"BINARY_CALL",parser:"as",lhs:{type:"RULE_CALL",name:"rule-expression"},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"expr"}}},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"PCLOSE"}}},code:function(e,t,r,a){return r.expr}},{type:"BINARY_CALL",parser:"then",lhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"QUESTION_MARK"}},rhs:{type:"BINARY_CALL",parser:"as",lhs:{type:"RULE_CALL",name:"parser-name"},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"arg"}}},code:function(e,t,r,a){return{type:"UNARY_CALL",parser:"opt",arg:r.arg}}},{type:"BINARY_CALL",parser:"then",lhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"PLUS"}},rhs:{type:"BINARY_CALL",parser:"as",lhs:{type:"RULE_CALL",name:"parser-name"},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"arg"}}},code:function(e,t,r,a){return{type:"UNARY_CALL",parser:"many1",arg:r.arg}}},{type:"BINARY_CALL",parser:"then",lhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"TIMES"}},rhs:{type:"BINARY_CALL",parser:"as",lhs:{type:"RULE_CALL",name:"parser-name"},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"arg"}}},code:function(e,t,r,a){return{type:"UNARY_CALL",parser:"many0",arg:r.arg}}},{type:"BINARY_CALL",parser:"then",lhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"COLON"}},rhs:{type:"BINARY_CALL",parser:"as",lhs:{type:"RULE_CALL",name:"parser-name"},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"arg"}}},code:function(e,t,r,a){return{type:"UNARY_CALL",parser:"token",arg:r.arg}}},{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"NAME"},code:function(e,t,r,a){return{type:"RULE_CALL",name:e}}}]},{type:"RULE",name:"rule-expression",definitions:[{type:"BINARY_CALL",parser:"then",lhs:{type:"BINARY_CALL",parser:"as",lhs:{type:"RULE_CALL",name:"parser-name"},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"lhs"}}},rhs:{type:"BINARY_CALL",parser:"then",lhs:{type:"BINARY_CALL",parser:"as",lhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"NAME"}},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"parser"}}},rhs:{type:"BINARY_CALL",parser:"as",lhs:{type:"RULE_CALL",name:"rule-expression"},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"rhs"}}}},code:function(e,t,r,a){return{type:"BINARY_CALL",parser:r.parser,lhs:r.lhs,rhs:r.rhs}}},{type:"BINARY_CALL",parser:"then",lhs:{type:"BINARY_CALL",parser:"as",lhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"NAME"}},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"name"}}},rhs:{type:"BINARY_CALL",parser:"as",lhs:{type:"RULE_CALL",name:"rule-expression"},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"arg"}}},code:function(e,t,r,a){return{type:"UNARY_CALL",parser:r.name,arg:r.arg}}},{type:"RULE_CALL",name:"parser-name"}]},{type:"RULE",name:"rule-eval",definitions:[{type:"BINARY_CALL",parser:"then",lhs:{type:"UNARY_CALL",parser:"opt",arg:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"PIPE_ARROW"}}},rhs:{type:"BINARY_CALL",parser:"as",lhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"CODE"}},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"code"}}},code:function(e,t,r,a){return r.code.substring(1,r.code.length-1)}}]},{type:"RULE",name:"rule-definition",definitions:[{type:"BINARY_CALL",parser:"then",lhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"PIPE"}},rhs:{type:"BINARY_CALL",parser:"then",lhs:{type:"BINARY_CALL",parser:"as",lhs:{type:"RULE_CALL",name:"rule-expression"},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"expr"}}},rhs:{type:"UNARY_CALL",parser:"opt",arg:{type:"BINARY_CALL",parser:"as",lhs:{type:"RULE_CALL",name:"rule-eval"},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"code"}}}}},code:function(e,t,r,a){return r.code&&(r.expr.code=r.code),r.expr}}]},{type:"RULE",name:"rule",definitions:[{type:"BINARY_CALL",parser:"then",lhs:{type:"BINARY_CALL",parser:"as",lhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"NAME"}},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"name"}}},rhs:{type:"BINARY_CALL",parser:"then",lhs:{type:"BINARY_CALL",parser:"as",lhs:{type:"UNARY_CALL",parser:"many1",arg:{type:"RULE_CALL",name:"rule-definition"}},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"definitions"}}},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"SEMICOLON"}}},code:function(e,t,r,a){return{type:"RULE",name:r.name,definitions:r.definitions}}}]},{type:"RULE",name:"rules",definitions:[{type:"UNARY_CALL",parser:"many0",arg:{type:"RULE_CALL",name:"rule"}}]},{type:"RULE",name:"start",definitions:[{type:"BINARY_CALL",parser:"then",lhs:{type:"BINARY_CALL",parser:"as",lhs:{type:"RULE_CALL",name:"lexer"},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"lexer"}}},rhs:{type:"BINARY_CALL",parser:"as",lhs:{type:"RULE_CALL",name:"rules"},rhs:{type:"UNARY_CALL",parser:"token",arg:{type:"RULE_CALL",name:"rules"}}},code:function(e,t,r,a){return[r.lexer].concat(r.rules)}},{type:"RULE_CALL",name:"rules"}]}]},{}],3:[function(e,t,r){const a=e("./token"),n={};t.exports=class{constructor(e){this.definitions=e,this.col=1,this.line=1}*lex(e){for(;""!==e;){const[t,r]=this.lexOne(e);if(null!==t&&(yield t),e===r)throw new Error(`Invalid token '${e[0]}' at line ${this.line}, column ${this.col}`);e=r}yield new a({name:"EOF",match:null,col:this.col,line:this.line})}lexOne(e){for(let t=0,r=this.definitions.length;t<r;t++){const r=this.definitions[t],s=r.matcher;if("TOKEN_MATCHER"===s.type){const t=s.match;if(e.substring(0,t.length)===t){const n="match"===r.action?new a({name:r.name,match:t,col:this.col,line:this.line}):null;return this.updatePosition(t),[n,e.substring(t.length)]}}else if("TOKEN_REGEX_MATCHER"===s.type){let t=r.matcher.regex;t="object"==typeof t?t:n[t]||(n[t]=new RegExp(t));const s=t.exec(e);if(null!==s&&0===s.index){const t="match"===r.action?new a({name:r.name,match:s[0],col:this.col,line:this.line}):null;return this.updatePosition(s[0]),[t,e.substring(s[0].length)]}}}return[null,e]}updatePosition(e){for(let t=0,r=e.length;t<r;t++)"\n"===e[t]?(this.line+=1,this.col=1):this.col+=1}}},{"./token":4}],4:[function(e,t,r){t.exports=class{constructor({name:e,match:t,line:r,col:a}){this.name=e,this.match=t,this.line=r||0,this.col=a||0}is(e){return this.name===e}toString(){return`<TOKEN ${this.name}: '${this.match}'>`}}},{}],5:[function(e,t,r){const a=e("../evaluator");t.exports=class{constructor(e,t,r){if(void 0===e[1].tokenName)throw new Error("AS combinator only works with a token as the RHS: '(my-parser as :somename)'");this.lhs=e[0],this.name=e[1].tokenName,this.code=t,this.rule=r}parse(e){const t=this.lhs.parse(e).clone();return t.matched={name:this.name,value:t.matched},this.code&&(t.matched=a.eval(this.code,t.matched)),t}getParsers(){return[this.lhs]}toString(){return`[AS ${this.lhs} ${this.name}]`}}},{"../evaluator":13}],6:[function(e,t,r){const a=e("../result"),n=e("../evaluator");t.exports=class{constructor(e,t,r){this.getParser=e,this._parser=null,this.code=t,this.rule=r}parse(e){const t=this.parser.parse(e);return t.failed?a.fail(t.remaining,this.rule):(this.code&&(t.matched=n.eval(this.code,t.matched)),t)}getParsers(){return[this.parser]}get parser(){return null===this._parser&&(this._parser=this.getParser()),this._parser}toString(){return`[CALL RULE ${this.parser}]`}}},{"../evaluator":13,"../result":17}],7:[function(e,t,r){const a=e("../result"),n=e("../evaluator");t.exports=class{constructor(e,t,r){this.parser=e,this.code=t,this.rule=r}parse(e){if(e.isEmpty())return a.ok(e);let t=e,r=[];for(;!t.isEmpty();){const e=this.parser.parse(t);if(null!==e.matched&&(r=r.concat(e.matched)),e.failed)return a.ok(t,this.code?n.eval(this.code,r):r);t=e.remaining}}getParsers(){return[this.parser]}toString(){return`[MANY0 ${this.parser}]`}}},{"../evaluator":13,"../result":17}],8:[function(e,t,r){const a=e("../result"),n=e("../evaluator");t.exports=class{constructor(e,t,r){this.parser=e,this.code=t,this.rule=r}parse(e){if(e.isEmpty())return a.fail(e,this.rule);let t=e,r=[];for(;!t.isEmpty();){const s=this.parser.parse(t);if(null!==s.matched&&(r=r.concat(s.matched)),s.failed)return 0===r.length?a.fail(e,this.rule):a.ok(t,this.code?n.eval(this.code,r):r);t=s.remaining}}getParsers(){return[this.parser]}toString(){return`[MANY1 ${this.parser}]`}}},{"../evaluator":13,"../result":17}],9:[function(e,t,r){const a=e("../result"),n=e("../evaluator");t.exports=class{constructor(e,t,r){this.parser=e,this.code=t,this.rule=r}parse(e){const t=this.parser.parse(e),r=this.code?n.eval(this.code,t.matched):t.matched;return a.ok(t.remaining,r)}getParsers(){return[this.parser]}toString(){return`[OPTIONAL ${this.parser}]`}}},{"../evaluator":13,"../result":17}],10:[function(e,t,r){const a=e("../result"),n=e("../evaluator");t.exports=class{constructor(e,t,r){this.parsers=e,this.code=t,this.rule=r}parse(e){for(let t=0,r=this.parsers.length;t<r;t++){const r=this.parsers[t].parse(e);if(r.succeeded)return this.code&&(r.matched=n.eval(this.code,r.matched)),r}return a.fail(e,this.rule)}getParsers(){return this.parsers}toString(){return this.rule?`<RULE: ${this.rule}>`:`[OR ${this.parsers.map(e=>e.toString()).join(" ")}]`}}},{"../evaluator":13,"../result":17}],11:[function(e,t,r){const a=e("../result"),n=e("../evaluator");t.exports=class{constructor(e,t,r){this.lhs=e[0],this.rhs=e[1],this.code=t,this.rule=r}parse(e){const t=this.lhs.parse(e);if(t.failed)return t;const r=this.rhs.parse(t.remaining);return r.succeeded?(r.matched=this.code?n.eval(this.code,t.matched,r.matched):[t.matched,r.matched],r):a.fail(e,this.rule)}getParsers(){return[this.lhs,this.rhs]}toString(){return`[THEN ${this.lhs} ${this.rhs}]`}}},{"../evaluator":13,"../result":17}],12:[function(e,t,r){let a=0;class n{log(e){console.log(e)}}t.exports=class{constructor(e,t){this.parser=e,this.logger=t||new n}parse(e){this.log(`${this.indentation}${this.parser}: START`),this.indent();const t=this.parser.parse(e);return this.dedent(),this.log(`${this.indentation}${this.parser}: ${t.succeeded?"OK":"FAIL"}`),t}getParsers(){return this.parser.getParsers()}get cacheKey(){return this.parser.cacheKey}toString(){return this.parser.toString()}get tokenName(){return this.parser.tokenName}log(e){this.logger.log(e)}indent(){a+=2}dedent(){a-=2}get indentation(){return Array(a).fill(" ").join("")}}},{}],13:[function(e,t,r){const a=e("../util/flatten");let n={};t.exports={eval(e,t,r){if(!e)return null;const s={},o=a([t,r]);for(let e=0,t=o.length;e<t;e++){const t=o[e];t&&Object.prototype.hasOwnProperty.call(t,"name")&&(s[t.name]=t.value)}return"function"==typeof e?e(t,r,s,n):new Function("$1","$2","$","$ctx",e)(t,r,s,n)},setContext(e){n=e}}},{"../util/flatten":22}],14:[function(e,t,r){const a=e("./token-parser");t.exports=class{constructor(e){this.parsers=e}check(){Object.keys(this.parsers).forEach(e=>this.checkRuleForLeftRecursion(e,e,[]))}checkRuleForLeftRecursion(e,t,r){this.parsers[e].getParsers().forEach(n=>{const s=this.leftmostFor(n);if(!(s instanceof a)){if(r.push(e),s.rule===t)throw new Error(`Left recursion found: ${r.join(" -> ")} -> ${t}`);r.includes(s.rule)||this.checkRuleForLeftRecursion(s.rule,t,r)}})}leftmostFor(e){if(void 0===e)throw new Error("Could not find leftmost parser");return e instanceof a||void 0!==e.rule?e:this.leftmostFor(e.getParsers()[0])}}},{"./token-parser":19}],15:[function(e,t,r){const a=new Map;t.exports=class{constructor(e,t){this.parser=e,this.cacheKey=t}static clear(){a.clear()}parse(e){const t=this.cacheKey^e.cacheKey;if(a.has(t))return a.get(t);const r=this.parser.parse(e);return a.set(t,r),r}getParsers(){return this.parser.getParsers()}toString(){return this.parser.toString()}get tokenName(){return this.parser.tokenName}}},{}],16:[function(e,t,r){const a=e("../lexer/lexer"),n=e("./token-list"),s=e("./token-parser"),o=e("./result"),p=e("./combinators/many0"),L=e("./combinators/many1"),i=e("./combinators/optional"),h=e("./combinators/or"),c=e("./combinators/then"),A=e("./combinators/identity"),m=e("./combinators/as"),y=e("./left-recursion-checker"),l=e("./memoizable-parser"),E=e("./debuggable-parser");const _={start:null,cache:!1,debug:!1,logger:null,lexer:null,combinators:{}};t.exports=class{constructor(e,t={}){this.combinators={binary:{or:h,then:c,as:m},unary:{many0:p,many1:L,opt:i}},this.parsers={},this.options=Object.assign({},_,t),this.lexer=this.options.lexer||this.buildLexer(e[0]),"LEXER"===e[0].type&&(e=e.slice(1)),this.buildCustomCombinators();const r=this.buildRules(e);if(this.start=this.options.start||r,null===this.start)throw new Error("No rules found");new y(this.parsers).check()}parse(e){this.options.cache&&l.clear(),o.clear();const t=this.parsers[this.start];if(!t)throw new Error(`Could not find starting parser: '${this.start}'`);return t.parse(new n(this.lexer.lex(e)))}getMostAdvancedFailure(){return o.getMostAdvancedFailure()}buildCustomCombinators(){this.options.combinators.unary&&Object.keys(this.options.combinators.unary).forEach(e=>{this.addCombinator(e,this.options.combinators.unary[e],"unary")}),this.options.combinators.binary&&Object.keys(this.options.combinators.binary).forEach(e=>{this.addCombinator(e,this.options.combinators.binary[e],"binary")})}addCombinator(e,t,r){if(!/[a-zA-Z][a-zA-Z0-9_-]*/.test(e))throw new Error("Invalid name. Combinators must start with a letter and only contain a-z, A-Z, 0-9, - and _");return this.combinators[r][e]=t,this}buildRules(e){let t=null;return e.forEach(e=>{const r=e.definitions.map(t=>this.parserFor(e.name,t));this.parsers[e.name]=this.decorate(new h(r,void 0,e.name),e),t=e.name}),t}parserFor(e,t){let r=null;return r="UNARY_CALL"===t.type?this.buildUnaryCall(e,t):"BINARY_CALL"===t.type?this.buildBinaryCall(e,t):this.buildRuleCall(e,t),this.decorate(r,t)}buildRuleCall(e,t){if("token"===t.name)throw new Error("Token can only be called as unary");const r=function(e,t,r){return function(){const a=e[t];if(void 0===a)throw new Error(`Could not find parser '${t}' in rule '${r}'`);return a}}(this.parsers,t.name,e);return new A(r,t.code)}buildBinaryCall(e,t){if("token"===t.parser)throw new Error("Token can only be called as unary");const r=this.combinators.binary[t.parser];if(void 0===r)throw new Error(`Could not find binary combinator: '${t.parser}' in rule '${e}'`);return new r([this.parserFor(e,t.lhs),this.parserFor(e,t.rhs)],t.code)}buildUnaryCall(e,t){if("token"===t.parser){if("RULE_CALL"!==t.arg.type)throw new Error("Tokens cannot call other rules or combinators");return new s(t.arg.name,t.code)}const r=this.combinators.unary[t.parser];if(void 0===r)throw new Error(`Could not find unary combinator: '${t.parser}' in rule '${e}'`);return new r(this.parserFor(e,t.arg),t.code)}decorate(e,t){let r=e;return!this.options.cache||e instanceof s||(r=new l(r,function(e){for(var t=0,r=0;t<e.length;t++)r=Math.imul(31,r)+e.charCodeAt(t)|0;return r}(JSON.stringify(t)))),this.options.debug&&(r=new E(r,this.options.logger)),r}buildLexer(e){if(void 0===e||"LEXER"!==e.type)throw new Error("Lexer was not defined in grammar. Define it or provide a custom lexer.");return new a(e.tokens)}}},{"../lexer/lexer":3,"./combinators/as":5,"./combinators/identity":6,"./combinators/many0":7,"./combinators/many1":8,"./combinators/optional":9,"./combinators/or":10,"./combinators/then":11,"./debuggable-parser":12,"./left-recursion-checker":14,"./memoizable-parser":15,"./result":17,"./token-list":18,"./token-parser":19}],17:[function(e,t,r){let a=null;t.exports=class e{constructor({success:e,remaining:t,matched:r}){this.success=e,this.remaining=t,this.matched=r||null}get failed(){return!this.success}get succeeded(){return this.success}clone(){return new e({success:this.success,remaining:this.remaining,matched:this.matched})}static ok(t,r){return new e({success:!0,remaining:t,matched:r})}static fail(t,r){return r&&(null===a||a.remaining.index<t.index)&&(a={remaining:t,rule:r}),new e({success:!1,remaining:t})}static getMostAdvancedFailure(){return a}static clear(){a=null}}},{}],18:[function(e,t,r){let a=0;t.exports=class e{constructor(e,t){const r=e.next();this.tokens=e,this.index=t||0,this.head=r.value,this.isDone=r.done,this._tail=null,this.objectId=a++}peek(e){return this.head.is(e)}isEmpty(){return this.done}get tail(){return null===this._tail&&(this._tail=new e(this.tokens,this.index+1)),this._tail}get cacheKey(){return this.objectId}}},{}],19:[function(e,t,r){const a=e("./result"),n=e("./evaluator");t.exports=class{constructor(e,t){this.tokenName=e,this.code=t,this._cacheKey=null}parse(e){return e.peek(this.tokenName)?a.ok(e.tail,this.code?n.eval(this.code,e.head.match):e.head.match):a.fail(e)}getParsers(){return[this]}toString(){return`[TOKEN ${this.tokenName}]`}}},{"./evaluator":13,"./result":17}],20:[function(e,t,r){const a=e("./parsers/parser"),n=e("./parsers/evaluator"),s=e("./self-parse");t.exports=class{constructor(e,t={}){if(!e)throw new Error("Please provide a grammar either as a string or a pre-compiled JavaScript object");const r="string"==typeof e?s(e):e;this.parser=new a(r,t),t.context&&n.setContext(t.context)}parse(e){if(!e)throw new Error("Input missing. Provide a string-able object.");const t=this.parser.parse(e.toString());if(t.succeeded){if(t.remaining.isEmpty()||t.remaining.head.is("EOF"))return t.matched;const{line:e,col:r}=t.remaining.head;throw new Error(`Syntax error line ${e}, column ${r}. Expected EOF, found ${t.remaining.head}`)}const r=this.parser.getMostAdvancedFailure(),{line:a,col:n}=r.remaining.head;throw new Error(`Syntax error line ${a}, column ${n}. In rule '${r.rule}', found ${r.remaining.head}`)}}},{"./parsers/evaluator":13,"./parsers/parser":16,"./self-parse":21}],21:[function(e,t,r){const a=e("./grammar"),n=e("./parsers/parser");t.exports=function(e){const t=new n(a),r=t.parse(e);if(r.succeeded){if(r.remaining.isEmpty()||r.remaining.head.is("EOF"))return r.matched;const{line:e,col:t}=r.remaining.head;throw new Error(`Syntax error line ${e}, column ${t}. Expected EOF, found <TOKEN ${r.remaining.head.name}: ${r.remaining.head.match}>`)}const s=t.getMostAdvancedFailure(),{line:o,col:p}=s.remaining.head;throw new Error(`Syntax error line ${o}, column ${p}. Expected '${s.rule}', found <TOKEN ${s.remaining.head.name}: ${s.remaining.head.match}>`)}},{"./grammar":2,"./parsers/parser":16}],22:[function(e,t,r){t.exports=function(e){for(let t=0;t<e.length;){const r=e[t];Array.isArray(r)?r.length>0?(r.unshift(t,1),e.splice.apply(e,r),r.splice(0,2)):e.splice(t,1):t++}return e}},{}]},{},[1]);